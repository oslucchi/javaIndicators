package javaIndicatorsTest.Trend;

import static org.junit.Assert.assertEquals;

import java.util.List;

import org.junit.Test;

import Tick.Tick;
import Tick.TickLogger;
import javaIndicators.Trend.Trend;
import utils.DataLoader;


public class testTrend {
	List<Tick> tickList;

	@Test
	public void testAccumulationDistributionLine() 
	{
		double[] resultsADL = {
				14663064.5161289, 26388867.5464319, 37687066.7060958, 43008856.9158863, 43435876.9158865, 
				33942246.4811044, 33829383.7592107, 21375746.5499084, 17105929.80114, 27400423.0784509, 
				4791839.74511756, 12603294.489643, 11688722.3246943, 9037131.81120434, 9232579.57239834, 
				28202932.6973985, 45396710.7376711, 53243983.464944, 64522142.3690538, 59318305.783688, 
				50106639.1170213, 61448930.0261122, 63723495.3594454, 76446150.1539659, 75321762.5570666, 
				86355903.2650313, 95301396.5983649, 90237133.756835, 65404094.1433087, 65247410.3826249, 
				64769350.382625, 83186221.0896955, 83881589.5107483, 81260164.8354236, 73690366.2846991, 
				85581642.4041023, 94414693.2515602, 79707609.9182269, 60919667.862152, 84487372.8004233, 
				96689267.8004235, 91242255.4927313, 87787609.8137189, 97715283.2831067, 114334657.033107, 
				97012717.0331065, 102300666.089711, 116689936.677946, 143758994.572683, 151052700.679553, 
				153030440.727228, 157820711.694971, 139578286.298145, 127467544.24207, 127681603.258463, 
				103324985.076645, 102045424.644991, 102773194.307912, 83234421.894119, 73080306.1533783, 
				80428109.8268477, 101217555.980694, 111299975.246749, 118559264.223127, 124182930.889794, 
				121929124.865697, 109159878.876393, 118761246.91763, 99223728.4674454, 114936059.614986, 
				107878326.281653, 111952901.622046, 126791181.15421, 74124500.8123302, 85394097.478997, 
				62875921.0084087, 57104168.4536643, 40139466.9265181, 11391511.4277967, 8992444.76113007, 
				25394333.2226685, 37597117.2226685, 48232572.1246294, 46405445.2015524, 44900522.1246296, 
				45084927.8389154, 46441255.2806428, 57499674.328262, 57504571.3265943, 50603911.3265943, 
				41954804.6599277, 51086317.0194783, 38692047.7979856, 40002747.7979856, 36727341.3463728, 
				26203815.0305831, 17770066.3580167, 12905279.1239743, 16263782.4026629, 10839684.2208446, 
				2435375.41255445, -11527724.0094108, -18180141.121864, -32023598.621864, -16079963.2236338, 
				2393496.15136625, 14931931.2163011, 13981476.6708465, 4051620.02060007, 17465837.9693179, 
				2617223.39645356, -42756953.9231341, -38678320.5898006, -17047538.6078187, -34705807.2645352, 
				-26650807.264535, -40736232.4443911, -62151066.415683, -55729023.0823497, -72242398.0823496, 
				-63851698.0823497, -72691738.0823496, -82127228.2784279, -85882550.35635, -76930546.510196, 
				-69992944.3596583, -59528469.3596583, -71463525.7232948, -58568165.7232948, -41929030.5881596, 
				-39140260.9252381, -36380643.5339336, -38050592.2518822, -45320625.5852157, -43226658.918549, 
				-53343308.9185491, -31124710.9185487, -37774710.9185486, -56497788.0839031, -46252624.2183569, 
				-47728690.0720155, -54930376.278912, -50522269.2366586, -67384739.3561804, -73439518.9182241, 
				-57985337.7588037, -46675561.2882154, -45050539.0659932, -66525214.6962453, -71457155.8727156, 
				-52570067.6374213, -71734715.2564688, -84070360.7110144, -80793403.1880785
		};
		
		tickList = DataLoader.populateTestData("docs/adlMarketData.ser");
		
		TickLogger tl = TickLogger.getInstance();

		Trend trend = new Trend(14, TickLogger.CONTINUOUS);
		Trend.AccumulationDistributionLine adl = trend.getAccumulationDistributionLine();
		for(int i = 0; i < tickList.size(); i++)
		{
			tl.addTick(tickList.get(i));
			trend.addItem();
			assertEquals(resultsADL[i], adl.getValue(), 0.000001);
//			System.out.println(adl.getValue() + " ");
		}
	}

	@Test
	public void testAverageDirectionalIndex() 
	{
		double[] resultsADX = {
				0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
				0.0, 0.0, 0.0, 0.0, 0.0, 
				0.0, 0.0, 0.0, 3.4316843824391126, 7.088961860592204, 
				11.364312807212388, 15.834337671131198, 20.486769654396046, 24.690184777036706, 28.893599899677366, 
				32.34009101683849, 35.78658213399962, 39.555530506782745, 43.405500715612696, 47.54175177490199, 
				51.84537618605898, 56.651641886270355, 57.26837263739966, 57.2625192978175, 56.615080220830635, 
				55.849589627194554, 55.24921275258729, 53.75450746483738, 51.57405792087074, 49.88762475157234, 
				48.15908245009518, 46.408273129812905, 43.18706088910038, 39.444506399161746, 36.34913449360371, 
				33.433741680341534, 31.276199433722308, 30.367679695834177, 28.87059576633415, 28.041685964719644, 
				26.551161515823278, 25.936197966259584, 25.65284496637255, 25.899884131369618, 26.18903242854545, 
				26.413529647180148, 27.470251320850284, 27.102267768826238, 25.9197282805539, 24.323491506729862, 
				22.987812226324913, 20.580761710198107, 19.80831165924788, 18.63950526169785, 16.751383200690004, 
				14.918441479266727, 13.809742886885152, 13.097644516029302, 12.602008178714017, 12.399679779605716, 
				11.77039552117659, 12.800877887208419, 12.895246985152488, 12.720692987298007, 13.145365947798448, 
				13.789378630287148, 14.16859159860665, 14.552489842489829, 15.673304081161712, 16.536410800178775, 
				17.029408096694198, 16.013351709007605, 15.348244941457649, 14.154291077424956, 13.426231794537356, 
				12.569474354046745, 12.806962232247415, 13.044450110448086, 12.614619042150379, 12.992624589167212, 
				12.612905845726166, 12.180458962732034, 12.236331907004693, 12.41841327264646, 12.252882548430351, 
				12.564296695220845, 12.600118483594809, 12.635940271968773, 13.293568956177207, 13.525078506076577, 
				13.707282245799034, 13.88948598552149, 13.42886945062003, 12.423161904805982, 13.009130958839105, 
				13.200773171090944, 14.914037793599558, 17.820747042806577, 20.823744210163323, 24.343156089400733, 
				26.436924220935826, 28.798189785049853, 31.371221922556916, 33.62258210372011, 36.28395198027054, 
				40.229991325171206, 44.62638543942016, 47.57483263936944, 48.93160323947155, 50.05444902105031, 
				49.631020048427324, 49.09608479299078, 48.81247370926239, 47.972157494925604, 48.443508652861006, 
				47.64639246368505, 46.79977177536405, 46.99225401224466, 46.19170069781851, 42.8572383111939, 
				39.27836274414801, 36.86648276825575, 34.820320317555634, 32.416403690817056, 29.6346268678141, 
				26.315014834061593, 22.995402800309083, 20.647156312297515, 18.465499077352565, 17.065119061985744, 
				15.55671381039029, 13.885694881849174, 12.074404064376655, 11.892998594016236, 12.28993060407083, 
				12.705068332869521, 12.451144289194888, 14.384710247570672, 17.376879050086036, 20.533009182888172, 
				22.875992358287455, 23.971690787455106, 25.37294612087685, 26.993894149252892, 29.101762669318582, 
				29.849665156857558, 31.50692343865814, 32.74622448249432
		};
		
		int[] resultsSynteticIndicator = {
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 
				1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -2, 
				-1, -1, -1, -1, -1, -1, -1, -1, 2, 1, 1, 1, 1, -2, -1, 2, -1, 
				-1, -1, -1, -1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
				1, 1, -2, -1, -1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
				-2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 
				-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 
				-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 
				-1, -1, -1, -1, -1, -1, -1, -1, -1, -1
		};
		
		tickList = DataLoader.populateTestData("docs/adxMarketData.ser");
		
		TickLogger tl = TickLogger.getInstance();

		Trend trend = new Trend(14, TickLogger.CONTINUOUS);
		Trend.AverageDirectionalIndex adx = trend.getAverageDirectionalIndex();
		tl.addTick(tickList.get(0));
		for(int i = 1; i < tickList.size(); i++)
		{
			tl.addTick(tickList.get(i));
			trend.addItem();
			assertEquals(resultsADX[i], adx.getValue(), 0.0000001);
			assertEquals(resultsSynteticIndicator[i], adx.getSytnteticIndicator());
//			System.out.println(adx.getValue() + " ");
		}
	}

}
